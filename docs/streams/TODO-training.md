# Task List — Stream 3: train_model.py + verify_data.py

<!-- Ralph picks the first unchecked task each iteration. TDD: write failing test, then implement. -->
<!-- SCOPE: Only modify train_model.py, verify_data.py, and ml/tests/test_train_*.py or ml/tests/test_verify_*.py -->

- [ ] Replace broad exceptions in load_data: in train_model.py load_data(), change the bare `except Exception as e:` around np.load to catch specific exceptions: `except (ValueError, OSError, EOFError) as e:`. These cover corrupted .npy files (ValueError), permission/missing files (OSError), and truncated files (EOFError). Write ml/tests/test_train_exceptions.py using tmp_path to create (a) a valid .npy file → loads successfully, (b) a truncated/corrupted file (write random bytes to a .npy path) → skipped with warning, (c) a file with wrong shape → skipped with warning. Verify load_data does not raise on any case.
- [ ] Add --learning_rate CLI arg: in train_model.py, add `--learning_rate` argument to parse_args() with default 0.001 and type float. In build_model(), change `optimizer="adam"` to `optimizer=tf.keras.optimizers.Adam(learning_rate=args.learning_rate)`. This requires passing args to build_model or the learning_rate value. Write ml/tests/test_train_lr.py that (a) imports parse_args and verifies --learning_rate defaults to 0.001, (b) verifies parse_args(["--learning_rate", "0.01"]) sets the value to 0.01, (c) imports build_model and verifies the returned model compiles without error.
- [ ] Add CLI args to verify_data.py: add argparse with `--data_path` (default: DATA_PATH from utils) and `--min_hands` (default: 15, type int) arguments. Replace hardcoded `DATA_PATH` and the `if hands_count < 15` threshold with the CLI values. Write ml/tests/test_verify_cli.py that (a) verifies default --data_path matches utils.DATA_PATH, (b) verifies --min_hands defaults to 15, (c) verifies --min_hands 10 sets threshold to 10. Only test argument parsing, not the full main() function.
- [ ] ALL_TASKS_COMPLETE
